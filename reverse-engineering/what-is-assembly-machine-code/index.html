<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Capture The Flag Competition Wiki"> 
    <meta name="author" content="OSIRIS Lab & CTFd LLC"> 
    <link rel="shortcut icon" href="../../img/favicon.ico">

    <title>What is Assembly/Machine Code - CTF 101</title>

    <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.018/css/hack.min.css">
    <link href='//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../../css/base.css" rel="stylesheet">
    <link href="../../css/cinder.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">


    <link href="../../admonition.css" rel="stylesheet">


    <link href="../../extra.css" rel="stylesheet">


    <link href="../../colorful.css" rel="stylesheet">


    <link href="../../zoom.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Gudea:400,400i,700" rel="stylesheet">
    <script>
    WebFont.load({
        google: {
            families: ['Open Sans', 'PT Sans']
        }
    });
    </script>

    
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->

            <a class="navbar-brand" href="../..">
                <img class="no-zoom" width="100px" src="/images/ctf101.png" title="CTF 101">
            </a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                
                    
                
                
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Forensics <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../forensics/overview/">Overview</a>
</li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">File Formats</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../forensics/what-are-file-formats/">What are File Formats</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Metadata</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../forensics/what-is-metadata/">What is Metadata</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Wireshark</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../forensics/what-is-wireshark/">What is Wireshark</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Stegonagraphy</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../forensics/what-is-stegonagraphy/">What is Stegonagraphy</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Disk Imaging</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../forensics/what-is-disk-imaging/">What is Disk Imaging</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Memory Forensics</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../forensics/what-is-memory-forensics/">What is Memory Forensics</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Hex Editors</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../forensics/what-is-a-hex-editor/">What is a Hex Editor</a>
</li>

        
    </ul>
  </li>

                        
                        </ul>
                    </li>
                
                
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Cryptography <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../cryptography/overview/">Overview</a>
</li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">XOR</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../cryptography/what-is-xor/">What is XOR</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Substitution Cipher</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../cryptography/what-is-a-substitution-cipher/">What is a Substitution Cipher</a>
</li>

        
            
<li >
    <a href="../../cryptography/what-is-caesar-cipher-rot-13/">Caesar Cipher/ROT 13</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Vigenere Cipher</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../cryptography/what-is-a-vigenere-cipher/">What is a Vigenere Cipher</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Hashing Functions</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../cryptography/what-are-hashing-functions/">What are Hashing Functions</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Modes of Operation</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../cryptography/what-are-block-ciphers/">What are Block Ciphers</a>
</li>

        
            
<li >
    <a href="../../cryptography/what-are-stream-ciphers/">What are Stream Ciphers</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">RSA</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../cryptography/what-is-rsa/">What is RSA</a>
</li>

        
    </ul>
  </li>

                        
                        </ul>
                    </li>
                
                
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Web Exploitation <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../web-exploitation/overview/">Overview</a>
</li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">SQL Injection</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../web-exploitation/sql-injection/what-is-sql-injection/">What is SQL Injection</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Command Injection</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../web-exploitation/command-injection/what-is-command-injection/">What is Command Injection</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Directory Traversal</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../web-exploitation/directory-traversal/what-is-directory-traversal/">What is Directory Traversal</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Cross Site Request Forgery</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../web-exploitation/cross-site-request-forgery/what-is-cross-site-request-forgery/">What is Cross Site Request Forgery</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Cross Site Scripting (XSS)</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../web-exploitation/cross-site-scripting/what-is-cross-site-scripting/">What is Cross Site Scripting</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Server Side Request Forgery</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../web-exploitation/server-side-request-forgery/what-is-server-side-request-forgery/">What is Server Side Request Forgery</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">PHP</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../web-exploitation/php/what-is-php/">What is PHP?</a>
</li>

        
    </ul>
  </li>

                        
                        </ul>
                    </li>
                
                
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reverse Engineering <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../overview/">Overview</a>
</li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Assembly/Machine Code</a>
    <ul class="dropdown-menu">
        
            
<li class="active">
    <a href="./">What is Assembly/Machine Code</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">The C Programming Language</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../what-is-c/">What is C</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Disassemblers</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../what-are-disassemblers/">What are Disassemblers</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Debuggers</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../what-is-gdb/">What is GDB</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Decompilers</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../what-are-decompilers/">What are Decompilers</a>
</li>

        
    </ul>
  </li>

                        
                        </ul>
                    </li>
                
                
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Binary Exploitation <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../binary-exploitation/overview/">Overview</a>
</li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Registers</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../binary-exploitation/what-are-registers/">What are Registers</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">The Stack</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../binary-exploitation/what-is-the-stack/">What is the Stack</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Calling Conventions</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../binary-exploitation/what-are-calling-conventions/">What are Calling Conventions</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Global Offset Table (GOT)</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../binary-exploitation/what-is-the-got/">What is the GOT</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Buffers</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../binary-exploitation/what-are-buffers/">What are Buffers</a>
</li>

        
            
<li >
    <a href="../../binary-exploitation/buffer-overflow/">Buffer Overflow</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Return Oriented Programming (ROP)</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../binary-exploitation/return-oriented-programming/">What is ROP</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Binary Security</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../binary-exploitation/what-is-binary-security/">What is Binary Security</a>
</li>

        
            
<li >
    <a href="../../binary-exploitation/no-execute/">No eXecute (NX)</a>
</li>

        
            
<li >
    <a href="../../binary-exploitation/address-space-layout-randomization/">Address Space Layout Randomization (ASLR)</a>
</li>

        
            
<li >
    <a href="../../binary-exploitation/stack-canaries/">Stack Canaries</a>
</li>

        
            
<li >
    <a href="../../binary-exploitation/relocation-read-only/">Relocation Read-Only (RELRO)</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">The Heap</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../binary-exploitation/what-is-the-heap/">What is the Heap</a>
</li>

        
            
<li >
    <a href="../../binary-exploitation/heap-exploitation/">Heap Exploitation</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">Format String Vulnerability</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../binary-exploitation/what-is-a-format-string-vulnerability/">What is a Format String Vulnerability</a>
</li>

        
    </ul>
  </li>

                        
                        </ul>
                    </li>
                
                
                
                </ul>

            <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                            <i class="fa fa-search"></i>
                        </a>
                    </li>
<!--                     <li >
                        <a rel="next" href="../overview/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../what-is-c/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li> -->
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="first-level active"><a href="#assemblymachine-code">Assembly/Machine Code</a></li>
            <li class="second-level"><a href="#from-source-to-compilation">From Source to Compilation</a></li>
                
            <li class="second-level"><a href="#x86-64">x86-64</a></li>
                
                <li class="third-level"><a href="#x86-64-registers">x86-64 Registers</a></li>
                <li class="third-level"><a href="#instructions">Instructions</a></li>
                <li class="third-level"><a href="#execution">Execution</a></li>
                <li class="third-level"><a href="#examples">Examples</a></li>
                <li class="third-level"><a href="#example-execution">Example Execution</a></li>
                <li class="third-level"><a href="#control-flow">Control Flow</a></li>
                <li class="third-level"><a href="#addresses">Addresses</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="assemblymachine-code">Assembly/Machine Code<a class="headerlink" href="#assemblymachine-code" title="Permanent link">&para;</a></h1>
<p>Machine Code or Assembly is code which has been formatted for direct execution by a CPU. Machine Code is the why readable programming languages like C, when compiled, cannot be reversed into source code (well <a href="">Decompilers</a> can sort of, but more on that later).</p>
<h2 id="from-source-to-compilation">From Source to Compilation<a class="headerlink" href="#from-source-to-compilation" title="Permanent link">&para;</a></h2>
<p><a href="https://godbolt.org">Godbolt</a> shows the differences in machine code generated by various compilers.</p>
<p>For example, if we have a simple C++ function:</p>
<div class="codehilite"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">char</span> <span class="n">c</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">fd</span> <span class="o">=</span> <span class="n">syscall</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">&quot;/etc/passwd&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">syscall</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fd</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">putchar</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>We can see the compilation results in some verbose instrucitons for the CPU:</p>
<div class="codehilite"><pre><span></span><span class="nl">.LC0:</span>
  <span class="na">.string</span> <span class="s">&quot;/etc/passwd&quot;</span>
<span class="nl">main:</span>
  <span class="nf">push</span> <span class="no">rbp</span>
  <span class="nf">mov</span> <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
  <span class="nf">sub</span> <span class="no">rsp</span><span class="p">,</span> <span class="mi">16</span>
  <span class="nf">mov</span> <span class="no">edx</span><span class="p">,</span> <span class="mi">0</span>
  <span class="nf">mov</span> <span class="no">esi</span><span class="p">,</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:.</span><span class="no">LC0</span>
  <span class="nf">mov</span> <span class="no">edi</span><span class="p">,</span> <span class="mi">2</span>
  <span class="nf">mov</span> <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
  <span class="nf">call</span> <span class="no">syscall</span>
  <span class="nf">mov</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="no">eax</span>
<span class="nl">.L3:</span>
  <span class="nf">lea</span> <span class="no">rdx</span><span class="p">,</span> <span class="p">[</span><span class="no">rbp-5</span><span class="p">]</span>
  <span class="nf">mov</span> <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">]</span>
  <span class="nf">mov</span> <span class="no">ecx</span><span class="p">,</span> <span class="mi">1</span>
  <span class="nf">mov</span> <span class="no">esi</span><span class="p">,</span> <span class="no">eax</span>
  <span class="nf">mov</span> <span class="no">edi</span><span class="p">,</span> <span class="mi">0</span>
  <span class="nf">mov</span> <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
  <span class="nf">call</span> <span class="no">syscall</span>
  <span class="nf">test</span> <span class="no">rax</span><span class="p">,</span> <span class="no">rax</span>
  <span class="nf">setne</span> <span class="no">al</span>
  <span class="nf">test</span> <span class="no">al</span><span class="p">,</span> <span class="no">al</span>
  <span class="nf">je</span> <span class="no">.L2</span>
  <span class="nf">movzx</span> <span class="no">eax</span><span class="p">,</span> <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-5</span><span class="p">]</span>
  <span class="nf">movsx</span> <span class="no">eax</span><span class="p">,</span> <span class="no">al</span>
  <span class="nf">mov</span> <span class="no">edi</span><span class="p">,</span> <span class="no">eax</span>
  <span class="nf">call</span> <span class="no">putchar</span>
  <span class="nf">jmp</span> <span class="no">.L3</span>
<span class="nl">.L2:</span>
  <span class="nf">mov</span> <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
  <span class="nf">leave</span>
  <span class="nf">ret</span>
</pre></div>


<p>This is a one way process for compiled languages as there is no way to generate source from machine code. While the machine code may seem unintelligble, the extremely basic functions can be interpreted with some practice.</p>
<h2 id="x86-64">x86-64<a class="headerlink" href="#x86-64" title="Permanent link">&para;</a></h2>
<p>x86-64 or amd64 or i64 is a 64-bit Complex Instruction Set Computing (CISC) architecture. This basically means that the registers used for this architecture extend an extra 32-bits on Intel's x86 architecture. CISC means that a single instruction can do a bunch of diferent things at once such as memory accesses, register reads, etc. It is also a variable-length instruction set which means diferent instructions can be diferent sizes ranging from 1 to 16 bytes long. And finally x86-64 allows for multi-sized register access which means that you can access certain parts of a register which are diferent sizes.</p>
<h3 id="x86-64-registers">x86-64 Registers<a class="headerlink" href="#x86-64-registers" title="Permanent link">&para;</a></h3>
<p>x86-64 registers behave similarly to other architectures. A key component of x86-64 registers is multi-sized access which means the register RAX can have its lower 32 bits accessed with EAX. The next lower 16 bits can be accessed with AX and the lowest 8 bits can be accessed with AL which allows for the compuler to make optimizations which boost program execution.
<img alt="Multi-access Register" src="../images/multi-access-register.png" /></p>
<p>x86-64 has plenty of registers to use including rax, rbx, rcx, rdx, rdi, rsi, rsp, rip, r8-r15, and more! But some registers serve special purposes.</p>
<p>The special registers include:
- RIP: the instruction pointer
- RSP: the stack pointer
- RBP: the base pointer</p>
<h3 id="instructions">Instructions<a class="headerlink" href="#instructions" title="Permanent link">&para;</a></h3>
<p>An <strong>instruction</strong> represents a single operation for the CPU to perform.</p>
<p>There are diferent types of instructions including:</p>
<ul>
<li>Data movement: <code class="codehilite">mov rax, [rsp - 0x40]</code></li>
<li>Arithmetic: <code class="codehilite">add rbx, rcx</code></li>
<li>Control-flow: <code class="codehilite">jne 0x8000400</code></li>
</ul>
<p>Because x86-64 is a CISC architecture, instructions can be quite complex for machine code such as <code class="codehilite">repne scasb</code> which repeats up to ECX times over memory at EDI looking for NULL byte (0x00), decrementing ECX each byte (Essentially strlen() in a single instruction!)</p>
<p>It is important to remember that an instruction really is just memory, this idea will become useful with Return Oriented Programming or ROP.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Instructions, numbers, strings, everything! Always represented in hex.</p>
</div>
<div class="codehilite"><pre><span></span>add rax, rbx
mov rax, 0xdeadbeef
mov rax, [0xdeadbeef] == 67 48 8b 05 ef be ad de
&quot;Hello&quot; == 48 65 6c 6c 6f
== 48 01 d8
== 48 c7 c0 ef be ad de
</pre></div>


<h3 id="execution">Execution<a class="headerlink" href="#execution" title="Permanent link">&para;</a></h3>
<p>What should the CPU execute? This is determined by the RIP register where IP means instruction pointer. Execution follows the pattern: fetch the instruction at the address in RIP, decode it, run it.</p>
<h3 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">&para;</a></h3>
<ol>
<li><code class="codehilite">mov rax, 0xdeadbeef</code></li>
</ol>
<p>Here the operation <code class="codehilite">mov</code> is moving the "immeadiate" <code class="codehilite">0xdeadbeef</code> into the register <code class="codehilite">RAX</code></p>
<ol>
<li><code class="codehilite">mov rax, [0xdeadbeef + rbx * 4]</code></li>
</ol>
<p>Here the operation <code class="codehilite">mov</code> is moving the data at the address of <code class="codehilite">[0xdeadbeef + RBX*4]</code> into the register <code class="codehilite">RAX</code>. When brackets are used, you can think of the program as getting the content from that effective address.</p>
<h3 id="example-execution">Example Execution<a class="headerlink" href="#example-execution" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span>-&gt; 0x0804000: mov eax, 0xdeadbeef            Register Values:
   0x0804005: mov ebx, 0x1234                RIP = 0x0804000
   0x080400a: add, rax, rbx                  RAX = 0x0
   0x080400d: inc rbx                        RBX = 0x0
   0x0804010: sub rax, rbx                   RCX = 0x0
   0x0804013: mov rcx, rax                   RDX = 0x0
</pre></div>


<div class="codehilite"><pre><span></span>   0x0804000: mov eax, 0xdeadbeef            Register Values:
-&gt; 0x0804005: mov ebx, 0x1234                RIP = 0x0804005
   0x080400a: add, rax, rbx                  RAX = 0xdeadbeef
   0x080400d: inc rbx                        RBX = 0x0
   0x0804010: sub rax, rbx                   RCX = 0x0
   0x0804013: mov rcx, rax                   RDX = 0x0
</pre></div>


<div class="codehilite"><pre><span></span>   0x0804000: mov eax, 0xdeadbeef            Register Values:
   0x0804005: mov ebx, 0x1234                RIP = 0x080400a
-&gt; 0x080400a: add, rax, rbx                  RAX = 0xdeadbeef
   0x080400d: inc rbx                        RBX = 0x1234
   0x0804010: sub rax, rbx                   RCX = 0x0
   0x0804013: mov rcx, rax                   RDX = 0x0
</pre></div>


<div class="codehilite"><pre><span></span>   0x0804000: mov eax, 0xdeadbeef            Register Values:
   0x0804005: mov ebx, 0x1234                RIP = 0x080400d
   0x080400a: add, rax, rbx                  RAX = 0xdeadd123
-&gt; 0x080400d: inc rbx                        RBX = 0x1234
   0x0804010: sub rax, rbx                   RCX = 0x0
   0x0804013: mov rcx, rax                   RDX = 0x0
</pre></div>


<div class="codehilite"><pre><span></span>   0x0804000: mov eax, 0xdeadbeef            Register Values:
   0x0804005: mov ebx, 0x1234                RIP = 0x0804010
   0x080400a: add, rax, rbx                  RAX = 0xdeadd123
   0x080400d: inc rbx                        RBX = 0x1235
-&gt; 0x0804010: sub rax, rbx                   RCX = 0x0
   0x0804013: mov rcx, rax                   RDX = 0x0
</pre></div>


<div class="codehilite"><pre><span></span>   0x0804000: mov eax, 0xdeadbeef            Register Values:
   0x0804005: mov ebx, 0x1234                RIP = 0x0804013
   0x080400a: add, rax, rbx                  RAX = 0xdeadbeee
   0x080400d: inc rbx                        RBX = 0x1235
   0x0804010: sub rax, rbx                   RCX = 0x0
-&gt; 0x0804013: mov rcx, rax                   RDX = 0x0
</pre></div>


<div class="codehilite"><pre><span></span>   0x0804000: mov eax, 0xdeadbeef            Register Values:
   0x0804005: mov ebx, 0x1234                RIP = 0x0804005
   0x080400a: add, rax, rbx                  RAX = 0xdeadbeee
   0x080400d: inc rbx                        RBX = 0x1235
   0x0804010: sub rax, rbx                   RCX = 0xdeadbeee
   0x0804013: mov rcx, rax                   RDX = 0x0
</pre></div>


<h3 id="control-flow">Control Flow<a class="headerlink" href="#control-flow" title="Permanent link">&para;</a></h3>
<p>How can we express conditionals in x86-64? We use conditional jumps such as:</p>
<ul>
<li><code class="codehilite">jnz &lt;address&gt;</code></li>
<li><code class="codehilite">je &lt;address&gt;</code></li>
<li><code class="codehilite">jge &lt;address&gt;</code></li>
<li><code class="codehilite">jle &lt;address&gt;</code></li>
<li>etc.</li>
</ul>
<p>They jump if their condition is true, and just go to the next instruction otherwise. These conditionals are checking EFLAGS which are special registers which store flags on certain instructions such as <code class="codehilite">add rax, rbx</code> which sets the o (overflow) flag if the sum is greater than a 64-bit register can hold, and wraps around. You can jump based on that with a <code class="codehilite">jo</code> instruction. The most important thing to remember is the cmp instruction:</p>
<div class="codehilite"><pre><span></span>cmp rax, rbx
jle error
</pre></div>


<p>This assembly jumps if RAX &lt;= RBX</p>
<h3 id="addresses">Addresses<a class="headerlink" href="#addresses" title="Permanent link">&para;</a></h3>
<p>Memory acts similarly to a big array where the indices of this "array" are memory addresses. Remember from earlier:</p>
<p><code class="codehilite">mov rax, [0xdeadbeef]</code></p>
<p>The square brackets mean "get the data at this address". This is analagous to the C/C++ syntax: <code class="codehilite">rax = *0xdeadbeef;</code></p></div>
            
        
    </div>

    <footer class="col-md-12 text-center">
        <hr>
        <p>
        <small>A project by the <a href="https://osiris.cyber.nyu.edu">OSIRIS Lab</a> at <a href="http://engineering.nyu.edu/">The NYU Tandon School of Engineering</a> and <a href="https://ctfd.io/">CTFd LLC</a></small>
    </footer>

    <script src="../../js/jquery-1.10.2.min.js"></script>
    <script src="../../js/bootstrap-3.0.3.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
    var base_url = '../..';
    </script>
    <script data-main="../../mkdocs/js/search.js" src="../../search/require.js"></script>
    <script src="../../js/base.js"></script>
    <script src="../../extra.js"></script>
    <script src="../../zoom-vanilla.min.js"></script>
    <script src="../../search/require.js"></script>
    <script src="../../search/search.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    </body>

</html>
